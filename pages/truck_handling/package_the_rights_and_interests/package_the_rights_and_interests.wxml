<wxs src='../../../utils/util.wxs' module='tools'/>
<view class="package-the-rights-and-interests">
    <!--套餐选择开始-->
    <view class="swiper-box">
        <swiper
                class="my-swiper {{listOfPackages.length === 1 ? 'my-only-swiper' : ''}}"
                indicator-dots="{{false}}"
                autoplay="{{false}}"
                next-margin="{{listOfPackages.length !== 1 ? '62rpx' : '12rpx'}}"
                previous-margin="12rpx"
                bindchange="currentChange"
                style="height: {{boxHeight[activeIndex]}}px;"
                circular="{{true}}">
            <swiper-item wx:for="{{listOfPackages}}" wx:key="index" class="my-swiper-item"
                         catchtap="onClickSwiper" data-index="{{index}}">
                <view class="my-swiper-item-box item-{{index}}">
                    <view class="package iconfont {{choiceIndex === index ? 'active' : ''}}">
                        <view>
                            <image src="{{item.productLogo}}" mode="widthFix"></image>
                        </view>
                        <view class="title-name">
                            <view class="title">{{item.productName}}</view>
                            <view class="sub-title">{{item.fullName}}</view>
                        </view>
                        <view>¥{{tools.parseNum(item.pledgePrice/100)}}</view>
                    </view>
                    <view class="related-service-title">
                        <view>基础服务</view>
                        <view class="tips">价值158元</view>
                    </view>
                    <view class="basic-service-list">
                        <view class="basic-service-item" wx:for="{{basicServiceList}}" wx:key="index">
                            <view class="iconfont logo {{item.ico}}">{{item.title}}</view>
                            <view class="tips">{{item.tips}}</view>
                        </view>
                        <view class="other-service-item other-service-first" catchtap="onClickCheckTheService" data-index="0">
                            <view>车主服务享便捷</view>
                            <view>价值168元</view>
                        </view>
                        <view class="other-service-item" wx:if="{{item.pledgePrice}}" catchtap="onClickCheckTheService" data-index="1">
                            <view>生活服务享精彩</view>
                            <view>价值100元+</view>
                        </view>
                    </view>
                    <view class="related-service-title" wx:if="{{item.flowVersion === 2}}">支持绑定以下银行卡</view>
                    <view class="basic-service-list" wx:if="{{item.flowVersion === 2}}">
                        <view class="basic-service-item bank">
                            <image src="/pages/default/assets/ccb.svg" mode="widthFix"></image>
                        </view>
                    </view>
                    <view class="pay-tips" wx:if="{{item.pledgePrice}}">注：付费产品支付成功且审核通过后，默认你已同意接受服务，不作申请退款。</view>
                </view>
            </swiper-item>
        </swiper>
    </view>
    <!--套餐选择结束-->
    <!--权益选择开始-->
    <view wx:if="{{rightsAndInterestsList.length}}"
          class="rights-and-interests {{listOfPackages.length === 1 ? 'my-only-equities' : ''}}">
        <view class="rights-and-interests-header">推荐加购以下权益包</view>
        <view class="rights-and-interests-list">
            <view wx:for="{{rightsAndInterestsList}}" wx:key="index"
                  class="rights-and-interests-item iconfont {{activeEquitiesIndex === index ? 'item-active' : ''}}"
                  catchtap="showRightsAndInterests" data-index="{{index}}">
                <image src="/pages/default/assets/equities_of_coupons.svg" mode="widthFix"></image>
                <view class="title">{{item.packageName}}</view>
                <view class="price">¥{{tools.parseNum(item.payMoney/100)}}</view>
            </view>
        </view>
    </view>
    <!--权益选择结束-->
    <!--下一步开始-->
    <view class="next">
        <button class="btn {{listOfPackages[activeIndex].mustChoiceRightsPackage === 1 && activeEquitiesIndex === -1 ? 'unavailable' : ''}}" catchtap="next"
                wx:if="{{choiceIndex !== -1 && listOfPackages[activeIndex].pledgePrice || (activeEquitiesIndex !== -1 && rightsAndInterestsList[activeEquitiesIndex].payMoney)}}">
            确认支付{{activeEquitiesIndex !== -1 ? tools.parseNum((listOfPackages[activeIndex].pledgePrice + rightsAndInterestsList[activeEquitiesIndex].payMoney)/100) : tools.parseNum(listOfPackages[activeIndex].pledgePrice/100)}}元
        </button>
        <button class="btn {{choiceIndex === -1 ? 'unavailable' : ''}}" catchtap="next" wx:else>下一步</button>
    </view>
    <!--下一步结束-->
    <!--查看权益详情开始-->
    <rights_package id="showRightsPackage" bindonClickHandle="onClickHandle" bindonClickDetailsHandle="onClickDetailsHandle" isSelected="{{isSelected}}" details="{{rightsPackageDetails}}"></rights_package>
    <!--查看权益详情结束-->
    <related_service id="viewRightsService" bindonClickHandle="onClickClose" details="{{serviceList[0]}}" wx:if="{{showServiceIndex === 0}}"></related_service>
    <life_service id="viewLifeService" bindonClickHandle="onClickClose" details="{{serviceList[1]}}" wx:if="{{showServiceIndex === 1}}"></life_service>
</view>
